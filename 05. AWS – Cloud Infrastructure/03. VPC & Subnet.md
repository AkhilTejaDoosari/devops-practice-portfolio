# AWS VPC & Subnets 

> IAM decides **who** gets the keys â€” defining users, roles, and permissions.  
> **VPC decides _where_ those keys work** â€” your private building inside the vast AWS city.  
>  
> In this city, every customer owns their own high-security building (VPC).  
> You design its layout: the rooms (subnets), doors (gateways), guards (security groups), and pathways (route tables).  
> Itâ€™s your isolated environment â€” fully customizable, secure, and connected only where you allow it.


## Table of Contents
1. [Why We Need a Network Layer](#1-why-we-need-a-network-layer)  
2. [What Is a VPC?](#2-what-is-a-vpc)  
3. [CIDR and IP Address Ranges](#3-cidr-and-ip-address-ranges)  
4. [Subnets and Availability Zones](#4-subnets-and-availability-zones)  
5. [Routing, IGW & NAT Gateway](#5-routing-igw--nat-gateway)  
6. [Security Groups vs NACLs](#6-security-groups-vs-nacls)  
7. [IP Concepts â€“ Private, Public, Elastic, ENI](#7-ip-concepts--private-public-elastic-eni)  
8. [Networking Foundations (DNS, TCP, OSI)](#8-networking-foundations-dns-tcp-osi)  
9. [Architecture Blueprint (End-to-End VPC Design)](#9-architecture-blueprint-end-to-end-vpc-design)  

---

<details>
<summary><strong>1. Why We Need a Network Layer</strong></summary>

Before the cloud, every company had its own physical space â€” a **server room full of blinking racks**, **tangled cables**, and **heavy routers** stacked like Lego blocks.  
Each application lived there, connected through actual wires. Expanding meant buying new machines, finding space, and rewiring everything.

Then came **AWS**, offering the same setup â€” but without the metal and cables.  
Now you build that whole network **virtually**.  
No electricians, no switches, no walls â€” just diagrams and clicks.  
That virtual space you design is your **VPC (Virtual Private Cloud)**.

Think of AWS as a huge city filled with skyscrapers (accounts).  
Inside that city, **your VPC is a private building** â€” fully yours.  
You decide:
- Who gets the keys to the building (**security**).
- Which rooms face the street (**public subnets**).
- Which stay locked inside (**private subnets**).
- How the hallways connect rooms (**route tables**).

Without a VPC, every AWS resource would just float around the city with no walls or doors â€” anyone could walk anywhere.  
**VPC gives you boundaries, privacy, and structure** â€” your own secure floor plan inside the AWS city.

```
AWS City (many accounts)
â””â”€â”€ Your Account (one skyscraper among many)
    â””â”€â”€ Your VPC = Your Private Building
        â”œâ”€â”€ Security = Keys & Guards at doors (IAM/Security Groups/NACLs)
        â”œâ”€â”€ Route Tables = Hallways deciding which room reaches which
        â”œâ”€â”€ Internet Gateway = Main entrance to the street (Internet)
        â”œâ”€â”€ Public Subnet = Street-facing rooms (web/bastion)
        â”‚     â””â”€ EC2/Web Server (has public + private IP)
        â””â”€â”€ Private Subnet = Internal rooms (DB/app)
              â””â”€ RDS/EC2 App (private IP only; no direct street access)
```

Traffic flow examples:
Internet User â†’ Main Entrance (IGW) â†’ Lobby â†’ Public Room (Web)
Public Room (Web) â†’ Hallway (Route) â†’ Private Room (DB)  [internal only]

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             AWS  city              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  Your Private skyscrapers  â”‚   â”‚
â”‚   â”‚     (VPC 10.0.0.0/16)      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
</details>

---

<details>
<summary><strong>2. What Is a VPC</strong></summary>

---

A **Virtual Private Cloud (VPC)** is your **private building inside the AWS city** â€” an isolated network space where you decide how things are connected, protected, and accessed.  

Within this building, every floor, door, and hallway is something you control:
- **Subnets** â†’ logical rooms or floors where specific workloads live.  
- **Route Tables** â†’ pathways that decide how traffic moves between rooms.  
- **Internet Gateway (IGW)** â†’ the main door to the public Internet.  
- **NAT Gateway** â†’ a controlled backdoor for private systems to go out safely.  
- **Security Groups & NACLs** â†’ firewalls at different levels â€” instance and subnet.  

When you first create an AWS account, you get a **Default VPC** (like a pre-built office).  
But professionals usually build **Custom VPCs** â€” so every range, subnet, and firewall rule is cleanly designed, traceable, and secure.

---

| Component | Purpose | Example |
|------------|----------|----------|
| **VPC** | Network boundary | `10.0.0.0/16` |
| **Subnet** | Sub-division of VPC | `10.0.1.0/24` |
| **Route Table** | Defines traffic paths | Route to IGW / NAT |
| **Internet Gateway (IGW)** | Public Internet access | Web tier in public subnet |
| **NAT Gateway** | Private â†’ Internet (egress) | OS updates from private EC2 |
| **Security Group (SG)** | Instance-level firewall (stateful) | Allow HTTP / SSH |
| **NACL** | Subnet-level firewall (stateless) | Allow / Deny by CIDR / port |

---

### Putting it all together

Now that you know each piece, imagine walking through your AWS building:

- The **VPC** is the building itself â€” walls define your limits.  
- **Subnets** divide floors by purpose (e.g., web on one, database on another).  
- **Route Tables** define how people and packets move between floors.  
- **IGW** is your public entrance.  
- **NAT Gateway** is your safe exit for internal teams.  
- **Security Groups** protect each server, while **NACLs** secure entire floors.  

---

### ğŸ“˜ Architecture Overview (Diagram)

```

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ AWS Region â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ VPC (10.0.0.0/16) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Public Subnet (10.0.1.0/24) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  â†³ NACL: Subnet-level firewall (stateless)                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚      â€¢ Inbound: Allow 80,443,22                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚      â€¢ Outbound: Allow 1024â€“65535                                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ EC2: Web Server (Public) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚  â†³ Security Group (SG): Instance-level firewall â”‚             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚     â€¢ Inbound: 80,443 from 0.0.0.0/0            â”‚             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚     â€¢ Outbound: All (stateful auto-return)      â”‚             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   NAT Gateway (for Private Subnet outbound Internet)              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   Route Table: 0.0.0.0/0 â†’ IGW                                    â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Private Subnet (10.0.2.0/24) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  â†³ NACL: Subnet-level firewall (stateless)                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚      â€¢ Inbound: Allow 3306 (MySQL) from Public Subnet             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚      â€¢ Outbound: Allow 80,443 â†’ NAT                               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ EC2: App Server â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚  â†³ SG: Allow 3306 inbound from Web SG  â”‚                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â”‚  â†³ Outbound: All                       â”‚                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   RDS Database (same subnet or isolated subnet)                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   â†³ SG: Allow inbound 3306 only from App SG                       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚   Route Table: 0.0.0.0/0 â†’ NAT                                    â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚          IGW â†” Internet Gate Way                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```
 **User-Oriented Flow Summary**

1. **User (Browser/SSH Client)**  
   â†’ sends a request to access the EC2 instance (for example, to open a website or start an SSH session).

2. **Internet â†’ Internet Gateway (IGW)**  
   â†’ The request first passes through the **Internet Gateway**, which connects the AWS VPC to the Internet.

3. **Public Subnet (protected by Network Access Control List â€“ NACL)**  
   â†’ The packet enters the public subnet where firewall rules at the subnet level (NACL) allow or deny the request.

4. **EC2 Instance (secured by Security Group â€“ SG)**  
   â†’ The instanceâ€™s **Security Group** checks whether traffic on ports 22 (SSH) or 80/443 (HTTP/HTTPS) is allowed.  
   If allowed, the user reaches the EC2 instance running an Apache/Nginx server or terminal environment.

5. **Public EC2 Instance â†’ Private EC2 Instance / Relational Database Service (RDS)**  
   â†’ Internal traffic moves over the **local route** within the VPC (no Internet involvement).  
   The web server can fetch content, connect to a database, or run learning material (e.g., Bash/Git examples from W3Schools).

6. **Private EC2 Instance â†’ Network Address Translation Gateway (NAT Gateway)**  
   â†’ When the private instance needs to download updates, learning scripts, or Git repositories,  
   it uses the **NAT Gateway** in the public subnet to access the Internet securely (outbound only).

7. **Return Path**  
   â†’ Responses from the instance (webpage, terminal output, or Git clone result) follow the same route in reverse,  
   returning through the IGW to the userâ€™s browser or SSH client. 

</details>

---
<details>
<summary><strong>3. CIDR and IP Address Ranges</strong></summary>

---

Before you design rooms or hallways inside your private AWS building, you first decide **how much land the building covers** and **how many rooms can fit inside**.  
That boundary is defined by **CIDR (Classless Inter-Domain Routing)** â€” it decides the total number of IP addresses your VPC owns.

---

### 3.1 The idea behind CIDR

A CIDR block looks like `10.0.0.0/16`.  
The first part (`10.0.0.0`) is the **starting address**, and the number after the slash (`/16`) tells AWS how much of that address range belongs to you.

The **smaller the number after the slash**, the **larger** your space.  
Each increase in the slash makes your range smaller â€” fewer addresses to hand out.

```
10.0.0.0/16  â†’  65,536 total addresses
10.0.1.0/24  â†’     256 total addresses
10.0.3.0/28  â†’      16 total addresses
```
Each block size comes from the same simple rule:

> **Total IPs = 2^(32 â€“ Subnet Mask)**

AWS keeps things practical â€” it only allows CIDRs between **/16** (largest) and **/28** (smallest),
and automatically holds back **5 IPs per subnet** for its own internal use.

---

### 3.2 A local picture â€” Florida & Delray Beach

Imagine your **entire office building (VPC)** spans a large property â€” say `10.0.0.0/16`.  
Each **floor (Subnet)** represents a smaller section like `10.0.1.0/24`,  
and each **office room (EC2 instance)** inside that floor gets its own private address such as `10.0.1.5`.  

No floor can extend beyond the total land your building occupies,  
ensuring each department (subnet) stays organized and isolated within the same property.

```
VPC (10.0.0.0/16) â†’ Entire building
Subnet (10.0.1.0/24) â†’ One floor
EC2 (10.0.1.5) â†’ One office room
```

---

<details>
<summary><strong> Math & Sizing (How many IPs fit?)</strong></summary>

---
### 3.3 Math & Sizing (How many IPs fit?)

You size your space with one rule:

**Total IPs = 2^(32 âˆ’ Subnet Mask)**  
AWS lets you build between **/16** (largest) and **/28** (smallest).  
Inside every subnet, AWS reserves 5 IPs (router, DNS, network ID, future use, broadcast).  
So: **Usable = Total âˆ’ 5**

| CIDR | Total IPs | Usable IPs (Total âˆ’ 5) | When to use it |
|------|-----------|------------------------|----------------|
| **/16** | 65,536 | 65,531 | Whole VPC range for large environments |
| **/17** | 32,768 | 32,763 | Big multi-AZ footprints |
| **/18** | 16,384 | 16,379 | Growing environments with many subnets |
| **/19** | 8,192 | 8,187 | Medium scale deployments |
| **/20** | 4,096 | 4,091 | Common â€œlarge subnetâ€ size |
| **/21** | 2,048 | 2,043 | App tiers with room to grow |
| **/22** | 1,024 | 1,019 | Busy service subnets |
| **/23** | 512 | 507 | Moderate traffic tiers |
| **/24** | 256 | 251 | Standard subnet size (very common) |
| **/25** | 128 | 123 | Smaller tiers / labs |
| **/26** | 64 | 59 | Tight tiers, NAT or ALB subnets |
| **/27** | 32 | 27 | Tiny control planes |
| **/28** | 16 | 11 | Minimum AWS size (test or jump box) |

> Anything below /28 (i.e., /29 to /32) is not supported for AWS subnets.

---

### 3.4 Quick examples

* `10.0.0.0/16` â†’ 2^(32âˆ’16) = 2^16 = 65,536 total â†’ 65,531 usable  
* `10.0.1.0/24` â†’ 2^(32âˆ’24) = 2^8 = 256 total â†’ 251 usable  
* `172.31.0.0/20` â†’ 2^(32âˆ’20) = 2^12 = 4,096 total â†’ 4,091 usable  
* `10.0.3.0/28` â†’ 2^(32âˆ’28) = 2^4 = 16 total â†’ 11 usable  

</details>

</details>

---

<details>
<summary><strong>4. Subnets and Availability Zones</strong></summary>

---

Once your VPCâ€™s boundaries are defined, the next step is to **divide that space** into smaller, functional zones â€” called **Subnets**.  
A subnet is a logical segment of your VPC that lives entirely inside **one Availability Zone (AZ)**.  
Each subnet is built for a specific purpose: some are open to the Internet, others stay private and isolated.

---

### 4.1 Public vs Private Subnets

| Subnet Type | Connectivity | Common Use |
|--------------|--------------|------------|
| **Public Subnet** | Connected to the Internet Gateway (IGW) | Web servers, bastion hosts |
| **Private Subnet** | Connected to a NAT Gateway (outbound only) | Databases, backend applications |

âœ… **Design Principle:**  
For fault tolerance and high availability, create **one public and one private subnet per AZ**.  
Each pair belongs to a different Availability Zone â€” so if one AZ fails, the other continues operating normally.

---

### 4.2 How subnets fit into your AWS building

Imagine your **VPC as the building**, and each **subnet as a floor**.  
Some floors are **public-facing** â€” they host reception or web servers that interact with visitors.  
Other floors are **restricted zones** â€” accessible only to staff and internal systems like databases or application servers.  

Each subnet connects to the rest of the building using **route tables**,  
and the presence (or absence) of an **Internet Gateway** decides whether that subnet is publicly reachable.

---

### 4.3 Example Layout

```

VPC (10.0.0.0/16)
â”œâ”€ Public Subnet A (10.0.1.0/24)
â”œâ”€ Private Subnet A (10.0.2.0/24)
â”œâ”€ Public Subnet B (10.0.3.0/24)
â””â”€ Private Subnet B (10.0.4.0/24)

```

Here, each pair (Public A + Private A, Public B + Private B) sits in different **Availability Zones**,  
creating redundancy across the region.

---

### 4.4 Architecture Snapshot

```

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ AWS Region â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ VPC (10.0.0.0/16) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                                                   â”‚ â”‚
â”‚ â”‚    Availability Zone A      Availability Zone B                   â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚ â”‚
â”‚ â”‚ â”‚ Public Subnet A       â”‚ â”‚ Public Subnet B       â”‚               â”‚ â”‚
â”‚ â”‚ â”‚ (10.0.1.0/24)         â”‚ â”‚ (10.0.3.0/24)         â”‚               â”‚ â”‚
â”‚ â”‚ â”‚ â†’ Internet Gateway    â”‚ â”‚ â†’ Internet Gateway    â”‚               â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚ â”‚
â”‚ â”‚ â”‚ Private Subnet A      â”‚ â”‚ Private Subnet B      â”‚               â”‚ â”‚
â”‚ â”‚ â”‚ (10.0.2.0/24)         â”‚ â”‚ (10.0.4.0/24)         â”‚               â”‚ â”‚
â”‚ â”‚ â”‚ â†’ NAT Gateway (out)   â”‚ â”‚ â†’ NAT Gateway (out)   â”‚               â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ â”‚
â”‚ â”‚                                                                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

Each subnet connects to the Internet or other subnets **only through defined routes**,  
ensuring clear separation between public-facing workloads and internal systems.

</details>

---

<details>
<summary><strong>5. Routing, Internet Gateway (IGW) & NAT Gateway</strong></summary>

---

Every subnet inside your VPC needs a **Route Table** â€” a set of rules that decide **where network traffic should go**.  
These routes determine how instances inside your VPC communicate with each other and with the outside world.

---

### 5.1 How Routing Works

Each subnet in your VPC is associated with exactly **one route table**.  
When an instance sends a packet, AWS checks the route table of that subnet and decides the next hop based on the destination IP address.

| Destination | Target | Purpose |
|--------------|---------|----------|
| `10.0.0.0/16` | `local` | Internal communication within the VPC |
| `0.0.0.0/0` | `igw-xxxx` | Outbound access to the Internet |
| `0.0.0.0/0` | `nat-xxxx` | Private subnet outbound Internet via NAT Gateway |

---

### 5.2 Internet Gateway (IGW)

An **Internet Gateway** connects your VPC to the Internet.  
It allows traffic to flow in and out for public subnets.  
Any instance with a public or Elastic IP and a route to the IGW can communicate directly with external networks.

| Feature | Description |
|----------|-------------|
| **Scope** | One per VPC |
| **Direction** | Two-way (inbound and outbound) |
| **Attachment** | Must be explicitly attached to the VPC |
| **Cost** | Free of charge |

If a subnetâ€™s route table points `0.0.0.0/0 â†’ IGW`, that subnet becomes **public**.

---

### 5.3 NAT Gateway (Network Address Translation)

A **NAT Gateway** allows private instances (without public IPs) to **initiate outbound connections** to the Internet, such as downloading patches or updates â€” while blocking all inbound traffic.  

This keeps your internal systems secure while still enabling them to access online resources.

| Feature | Description |
|----------|-------------|
| **Scope** | One per Availability Zone |
| **Direction** | Outbound only (no inbound) |
| **Connectivity** | Uses Elastic IP + resides in a public subnet |
| **Cost** | Charged hourly + per-GB processed |

If a private subnetâ€™s route table points `0.0.0.0/0 â†’ NAT Gateway`, instances inside it can reach the Internet **outbound only**.

---

### 5.4 Example Flow

1. A user accesses your application via the Internet.  
2. The request enters the VPC through the **Internet Gateway** and reaches the **public subnet** (web tier).  
3. The web tier communicates internally with the **private subnet** (app/database tier) via local routing.  
4. Private instances connect to the Internet (for updates or external APIs) through the **NAT Gateway**.  
5. The NAT Gateway forwards responses back, maintaining the private subnetâ€™s isolation.

---

### 5.5 Architecture Snapshot

```

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ AWS Region â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                              â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ VPC (10.0.0.0/16) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚       â”‚                                                                               â”‚      â”‚
â”‚       â”‚  Public Subnet (10.0.1.0/24)           Private Subnet (10.0.2.0/24)           â”‚      â”‚
â”‚       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚      â”‚
â”‚       â”‚  â”‚  EC2: Web Server (Public)  â”‚        â”‚ EC2: App/DB (Private)      â”‚         â”‚      â”‚
â”‚       â”‚  â”‚  Route: 0.0.0.0/0 â†’ IGW    â”‚        â”‚ Route: 0.0.0.0/0 â†’ NAT     â”‚         â”‚      â”‚
â”‚       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚      â”‚
â”‚       â”‚                                                                               â”‚      â”‚
â”‚       â”‚  IGW â†” Internet                                                               â”‚      â”‚
â”‚       â”‚  NAT Gateway (in public subnet) â†’ Outbound for private subnet                 â”‚      â”‚
â”‚       â”‚                                                                               â”‚      â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

Traffic Summary:  
- **Inbound Internet â†’ IGW â†’ Public Subnet â†’ EC2 (Web/App)**  
- **Internal traffic â†’ Route Table (local)**  
- **Private outbound â†’ NAT Gateway â†’ IGW â†’ Internet**

</details>

---

<details>
<summary><strong>6. Security Groups vs Network ACLs (NACLs)</strong></summary>

---

Once your network layout is built, the next question is **who gets access** and **at what level**.  
AWS gives you two primary layers of control:

1. **Security Groups (SG)** â€“ act at the **instance level**.  
2. **Network ACLs (NACLs)** â€“ act at the **subnet level**.

Together, they form your buildingâ€™s **security framework** â€” door locks for individual rooms (SGs) and entry gates for entire floors (NACLs).

---

### 6.1 Security Groups (SG)

A **Security Group** is a **stateful firewall** attached to individual EC2 instances, load balancers, or other resources.  
Stateful means that if an inbound rule allows traffic in, the corresponding outbound traffic is automatically allowed â€” even if thereâ€™s no explicit outbound rule.

| Feature | Description |
|----------|-------------|
| **Level** | Instance (EC2, ENI, ALB, etc.) |
| **Behavior** | Stateful â€“ return traffic automatically allowed |
| **Rules** | Only â€œAllowâ€ rules (no Deny) |
| **Default Behavior** | Deny all inbound, allow all outbound |
| **Typical Use** | Web servers, application servers |

**Example â€“ Web Server SG**
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
| Direction  | Protocol  | Port            | Source   | Purpose          |
|------------|-----------|-----------------|----------|------------------|
| Inbound    | TCP       | 22 | 0.0.0.0/0  | SSH      | for admin access |
| Inbound    | TCP       | 80 | 0.0.0.0/0  | HTTP     | web traffic      |
| Inbound    | TCP       | 443 | 0.0.0.0/0 | HTTPS    | secure traffic   |
| Outbound   | All | All | 0.0.0.0/0       | Allow    | return responses |
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
---

### 6.2 Network ACLs (NACLs)

A **Network Access Control List (NACL)** is a **stateless firewall** that operates at the **subnet level**.  
Stateless means that inbound and outbound rules are evaluated **separately** â€” both directions must be explicitly allowed.

| Feature | Description |
|----------|-------------|
| **Level** | Subnet |
| **Behavior** | Stateless â€“ inbound and outbound checked separately |
| **Rules** | Can Allow or Deny |
| **Rule Order** | Evaluated in numeric order (lowest first) |
| **Default Behavior** | Allow all inbound and outbound |
| **Typical Use** | Additional subnet boundary protection |

**Example â€“ Public Subnet NACL**
| Rule # | Direction | Action | Protocol | Port Range | Source | Purpose |
|---------|------------|---------|-----------|-------------|---------|----------|
| 100 | Inbound | ALLOW | TCP | 80,443,22 | 0.0.0.0/0 | Allow web + SSH |
| 110 | Outbound | ALLOW | TCP | 1024â€“65535 | 0.0.0.0/0 | Allow return traffic |
| * | * | DENY | All | All | All | Default deny catch-all |

---

### 6.3 Comparison Summary

| Feature | **Security Group (SG)** | **Network ACL (NACL)** |
|----------|-------------------------|--------------------------|
| **Level** | Instance (ENI) | Subnet |
| **Statefulness** | âœ… Stateful | âŒ Stateless |
| **Default Behavior** | Inbound Deny / Outbound Allow | Allow All |
| **Supports Deny Rules** | âŒ No | âœ… Yes |
| **Evaluation Order** | All rules apply | Lowest number first |
| **Typical Usage** | Fine-grained access control | Broad subnet boundaries |
| **Recommended Practice** | Use SGs for most cases; NACLs for extra subnet protection | Combined use for layered security |

---

### 6.4 Architecture Snapshot
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ VPC (10.0.0.0/16) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Public Subnet â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â†³ NACL: Subnet-level filter                            â”‚ â”‚
â”‚ â”‚ â€¢ Allows ports 80, 443, 22                             â”‚ â”‚
â”‚ â”‚                                                        â”‚ â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ EC2 Instance â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚ â”‚
â”‚ â”‚ â”‚ â†³ Security Group: Instance firewall     â”‚            â”‚ â”‚
â”‚ â”‚ â”‚ â€¢ Allows 80, 443 inbound                â”‚            â”‚ â”‚
â”‚ â”‚ â”‚ â€¢ Outbound auto-allowed                 â”‚            â”‚ â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
---

**Quick takeaway:**  
Use **Security Groups** for everyday access control â€” theyâ€™re simple, reliable, and stateful.  
Add **NACLs** only when you need an additional layer of subnet-level defense.

</details>

---

<details>
<summary><strong>7. IP Concepts â€“ Private, Public, Elastic, ENI</strong></summary>

## IP Concepts â€“ Addresses Inside Your Building

Every EC2 instance inside your **VPC (your private building inside the AWS city)** needs an address to communicate â€” both **internally** and **externally**.  
These addresses define how your resources talk to one another and how they reach the outside Internet.  

Each EC2 instance can have four types of network identifiers:

- **Private IP** â†’ for internal communication within your building (VPC).  
- **Public IP** â†’ for temporary Internet access through the main entrance (Internet Gateway).  
- **Elastic IP** â†’ a permanent, reusable public address for consistent external access.  
- **ENI (Elastic Network Interface)** â†’ the virtual network panel that stores these addresses and connects instances to the network.

---

### 7.1 Private IP â€“ The Room Address Inside Your Building

Whenever you launch an EC2 instance inside your VPC, AWS automatically assigns it a **Private IP address**.  

This address is used for **internal communication** â€”  
for example, your web server on one floor talking to your database room on another, all within the same secured building.  

A Private IP **remains the same** even if you restart the instance,  
but it is **released permanently** when you remove the instance (terminate it).  

Private IPs are **free of cost** and **invisible from outside the building (the Internet)** â€” they function only within your internal network boundaries.

**Example**
Instance A â†’ Private IP: 10.0.0.5
Instance B â†’ Private IP: 10.0.0.8

Both rooms can communicate freely because they exist inside the same building (VPC).

**Analogy:**  
A **Private IP** is your **room number inside the building** â€”  
employees within the same premises can reach you directly,  
but outsiders from the city cannot see or contact you.

---

### 7.2 Public IP â€“ Internet-Facing Address

When an EC2 instance is launched in a **public subnet**, AWS assigns it a **Public IP address**.  
This allows the instance to communicate directly with the Internet through an **Internet Gateway (IGW)**.

A Public IP is **temporary**.  
If you stop or terminate the instance, the address is released and a new one is assigned when it starts again.  
Public IPs are included under the AWS Free Tier for up to 750 hours per month.

**Example**
```

Private IP: 10.0.0.12
Public IP: 3.120.55.23

```

You can connect to the instance using SSH:
```
ssh -i mykey.pem ec2-user@3.120.55.23
```

If the instance restarts, the Public IP might change to a new value such as `13.210.40.50`.

---

### 7.3 Elastic IP â€“ Static Public Address

An **Elastic IP (EIP)** is a **static public IPv4 address** that you allocate to your AWS account.  
Unlike a regular Public IP, an Elastic IP address remains the same even when an instance is stopped, restarted, or replaced.  

You can attach an Elastic IP to any instance in a public subnet, detach it when not needed, and reassign it to another instance at any time.  
Elastic IPs are **free while attached** to a running instance, but AWS charges for **idle addresses** that are allocated but unused.

**Example**

```
Elastic IP: 18.220.45.90
Associated Instance: EC2-Web-Server
```

Even after restart:

```
Elastic IP: 18.220.45.90 (Permanent)
```
---

### 7.4 ENI (Elastic Network Interface)

An **Elastic Network Interface (ENI)** is a **virtual network card** that connects an EC2 instance to the VPC network.  
Each ENI contains one or more **Private IPs**, optional **Public or Elastic IPs**, and associated **Security Groups**.

ENIs can be created independently and attached or detached from instances as needed.  
They are commonly used for **high availability**, **multi-homed network setups**, or **failover configurations**.

| Attribute | Description |
|------------|--------------|
| **Primary ENI** | Created automatically when an instance is launched |
| **Secondary ENI** | Can be attached manually for redundancy or network segregation |
| **Contains** | Private IPs, Public/Elastic IPs, MAC address, Security Groups |
| **Use Case** | Load balancing, failover, or separate management networks |

**Example**
ENI ID: eni-0a12b3c4d567890ef
Attached Instance: EC2-App-Server
Private IP: 10.0.0.8
Public IP: 3.90.55.21
Security Group: sg-0f12a3b4c567890de

---

Hereâ€™s that entire **Comparison + Diagram section** rewritten in your new, clean technical format â€” no analogies, no emojis, just structured AWS clarity.
It fits perfectly after your Elastic IP and ENI sections.

---

### 5. Comparison Summary

| IP Type | Purpose | Persistence | Cost | Notes |
|----------|----------|-------------|------|--------|
| **Private IP** | Internal communication within the VPC | Persists on restart | Free | Used for traffic between instances inside the same VPC |
| **Public IP** | Direct Internet access via IGW | Changes on restart | Free (up to 750 hrs/mo) | Automatically assigned to instances in public subnets |
| **Elastic IP** | Static public IPv4 address | Fixed and reusable | Free if attached; billed if idle | Manually allocated and can be reattached to any instance |
| **ENI** | Network interface for EC2 | N/A | Free | Holds IPs, MAC address, and Security Group associations |

---

### 6. Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ AWS Environment â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ VPC (10.0.0.0/16)â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                            â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Public Subnet (10.0.1.0/24) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚   â”‚  â”‚  EC2 Instance: Web Server                                         â”‚     â”‚   â”‚
â”‚   â”‚  â”‚  Private IP: 10.0.0.12                                            â”‚     â”‚   â”‚
â”‚   â”‚  â”‚  Public IP: 3.120.55.23                                           â”‚     â”‚   â”‚
â”‚   â”‚  â”‚  Elastic IP (optional): 18.220.45.90                              â”‚     â”‚   â”‚
â”‚   â”‚  â”‚  Route: 0.0.0.0/0 â†’ Internet Gateway (IGW)                        â”‚     â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚   â”‚                                                                            â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Private Subnet (10.0.2.0/24) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚   â”‚  â”‚  EC2 Instance: Application / Database Server                      â”‚     â”‚   â”‚
â”‚   â”‚  â”‚  Private IP: 10.0.0.8                                             â”‚     â”‚   â”‚
â”‚   â”‚  â”‚  Route: 0.0.0.0/0 â†’ NAT Gateway                                   â”‚     â”‚   â”‚
â”‚   â”‚  â”‚  No Public IP (internal access only)                              â”‚     â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚   â”‚                                                                            â”‚   â”‚
â”‚   â”‚  IGW â†” Internet                                                            â”‚   â”‚
â”‚   â”‚  NAT Gateway â†’ Outbound Internet for Private Subnet                        â”‚   â”‚
â”‚   â”‚                                                                            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
Traffic Flow Summary:
- Public instance â†” Internet through **Internet Gateway (IGW)**.  
- Private instance â†” Internet (outbound only) through **NAT Gateway**.  
- Internal communication via **Private IPs** within the same VPC.  
- **ENI** stores and manages each instanceâ€™s IP configuration and Security Groups.

</details>

---

<details>
<summary><strong>8. Networking Foundations (DNS, TCP, OSI)</strong></summary>

## Why do we need prerequisites before OSI?

Before the OSI model starts wrapping and sending data, two things usually happen first:  
1. We find the serverâ€™s **IP address**.  
2. We make sure thereâ€™s a **reliable connection**.



---

## A) Domain Name System (DNS)

DNS translates a **domain name** (like `google.com`) into its **corresponding IP address**.  
It acts as the Internetâ€™s address book, enabling users to reach servers without memorizing IPs.

**Steps:**
1. Browser checks its local cache.  
2. If not found â†’ asks the **router** â†’ then your **ISPâ€™s DNS**.  
3. ISP may ask **Root** â†’ **TLD** (like `.com`) â†’ **Authoritative** DNS server.  
4. The authoritative server replies with the correct **IP address** (e.g., `142.250.xx.xx`).

> Without DNS, weâ€™d have to memorize IPs instead of names â€” like remembering every restaurantâ€™s GPS coordinates.

---

## B) Transmission Control Protocol (TCP) â€“ 3-Way Handshake

*Analogy:* Starting a phone call:  
- You: â€œHello, can you hear me?â€  
- Server: â€œYes, I can.â€  
- You: â€œGreat, letâ€™s talk.â€

**Steps:**
1. **SYN (Synchronize)** â†’ Client: â€œI want to connect.â€  
2. **SYN-ACK (Synchronize + Acknowledge)** â†’ Server: â€œI hear you; Iâ€™m ready.â€  
3. **ACK (Acknowledge)** â†’ Client: â€œConfirmed, letâ€™s begin.â€

Now the connection is reliable.  
(When using **HTTPS**, a **TLS handshake** happens right after this to secure the communication.)

---

## C) OSI 7 Layers (Top â†’ Bottom)

---

### Layer 7 â€” Application

This is where the **user interacts** directly.  
Example: You type `https://www.google.com` â†’ your browser sends an **HTTP/HTTPS request** because **you asked for it**.

Common protocols:  
- **HTTP/HTTPS** â€“ web traffic  
- **FTP** â€“ file transfers  
- **SMTP/IMAP** â€“ emails

---

### Layer 6 â€” Presentation

Handles **formatting, encryption, and compression** so the data looks correct and secure.  
Example: HTTPS encrypts your message before sending.

---

### Layer 5 â€” Session

Creates and maintains **sessions** between two systems.  
Example: You log in to **Instagram**, and for the next few minutes you donâ€™t need to log in again â€” the session is active.  
If you log out or it expires, the session closes.

---

### Layer 4 â€” Transport

Breaks big data into **segments**, numbers them, and ensures everything arrives correctly.  
Two key protocols live here:

- **TCP** â†’ Reliable, ordered, connection-based (used by HTTPS).  
- **UDP** â†’ Faster, connectionless, no guarantee (used by video calls, games, DNS queries).

Example: Sending a **10 GB wedding video** â€” itâ€™s split into small numbered pieces that are reassembled on the other side.

---

### Layer 3 â€” Network

Adds **IP addresses** and decides how to reach the destination.  
Routers pick the **best path** to get data from your computer to the target server.

Example: Going from **Delhi â†’ Mumbai**, there are many roads; the router picks the fastest route.

---

### Layer 2 â€” Data Link

Works inside your **local network (LAN, Wi-Fi, Ethernet)**.  
It converts **packets â†’ frames** and adds **MAC addresses** for local delivery.

Example: Your router knows which device to send data to â€” your phone or your laptop â€” using their unique MAC IDs.

---

### Layer 1 â€” Physical

Turns everything into **bits (0s and 1s)** and sends them as signals over **wires or air**.  
Examples: Fiber optics, copper cables, Wi-Fi signals.

---

## D) Encapsulation & Decapsulation

When you send data, it moves **down** through all layers (7 â†’ 1).  
When the receiver gets it, it moves **up** (1 â†’ 7).

```

Sender:   L7 â†’ L6 â†’ L5 â†’ L4 â†’ L3 â†’ L2 â†’ L1  (wrap the data)
Network:  --- bits travel through wires/Wi-Fi ---
Receiver: L1 â†’ L2 â†’ L3 â†’ L4 â†’ L5 â†’ L6 â†’ L7  (unwrap the data)

```
---

**Key Takeaways:**
1. **DNS** finds where to send data.  
2. **TCP handshake** makes the connection reliable.  
3. **OSI layers** define how the message is wrapped, sent, and understood.  
4. Each layer adds its own â€œboxâ€ to keep communication smooth and universal.

</details>

---

<details>
<summary><strong>9. Architecture Blueprint â€“ End-to-End VPC Design</strong></summary>

---

### 9.1 Example: Two-Tier Web Application

**Region:** us-east-1  
**VPC:** 10.0.0.0/16  

```

â”œâ”€ Public Subnet-A (10.0.1.0/24) â†’ EC2 Web Server + Internet Gateway
â””â”€ Private Subnet-A (10.0.2.0/24) â†’ RDS Database + NAT Gateway

```

**Traffic Flow**
1. Internet user sends a request to the web serverâ€™s public IP or Elastic IP.  
2. The request passes through the **Internet Gateway (IGW)** into the **Public Subnet**.  
3. The **EC2 Web Server** handles the request and queries the **RDS Database** inside the **Private Subnet** through the VPCâ€™s local route.  
4. The database responds through the same internal routeâ€”never exposed to the Internet.  
5. When the private subnet needs outbound access (for patching or API calls), traffic goes through the **NAT Gateway** in the public subnet.  

---

### 9.2 Security Controls
| Layer | Component | Function |
|--------|------------|-----------|
| **Per Instance** | Security Groups | Control inbound/outbound traffic to specific EC2 or RDS resources |
| **Per Subnet** | Network ACLs | Define allowed or denied CIDR ranges at the subnet level |
| **Edge** | Internet / NAT Gateway | Manage inbound and outbound Internet connectivity |

---

### 9.3 Architecture Snapshot

```

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ AWS Region â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                            â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ VPC (10.0.0.0/16) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚        â”‚                                                                         â”‚         â”‚
â”‚        â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Public Subnet (10.0.1.0/24) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚         â”‚
â”‚        â”‚   â”‚ EC2 Web Server                                                  â”‚   â”‚         â”‚
â”‚        â”‚   â”‚  - Public IP / Elastic IP                                       â”‚   â”‚         â”‚
â”‚        â”‚   â”‚  - Security Group: allow HTTP/HTTPS, SSH                        â”‚   â”‚         â”‚
â”‚        â”‚   â”‚ Route: 0.0.0.0/0 â†’ Internet Gateway                             â”‚   â”‚         â”‚
â”‚        â”‚   â”‚ NAT Gateway â†’ Outbound Internet for Private Subnet              â”‚   â”‚         â”‚
â”‚        â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚         â”‚
â”‚        â”‚                                                                         â”‚         â”‚
â”‚        â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Private Subnet (10.0.2.0/24) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚         â”‚
â”‚        â”‚   â”‚ RDS Database / Application Server                               â”‚   â”‚         â”‚
â”‚        â”‚   â”‚  - Private IP only                                              â”‚   â”‚         â”‚
â”‚        â”‚   â”‚  - Security Group: allow MySQL (3306) from Web SG               â”‚   â”‚         â”‚
â”‚        â”‚   â”‚ Route: 0.0.0.0/0 â†’ NAT Gateway (outbound only)                  â”‚   â”‚         â”‚
â”‚        â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚         â”‚
â”‚        â”‚                                                                         â”‚         â”‚
â”‚        â”‚  IGW â†” Internet                                                         â”‚         â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

### 9.4 Summary

- **VPC** provides isolation and IP range control.  
- **Public Subnet** hosts resources that require Internet access.  
- **Private Subnet** keeps internal services secure.  
- **IGW** handles inbound/outbound public traffic.  
- **NAT Gateway** enables private resources to reach the Internet safely.  
- **Security Groups and NACLs** enforce least-privilege access across all tiers.

</details>